<script type="text/x-red" data-template-name="digitalout">
    <div class="form-row">
        <label for=""><i class="fa fa-microchip"></i> Board</label>
        <select id="node-input-board" type="text">
            <option value="">select deploy board ...</option>
            <option value="RAVEN">RAVEN</option>
            <option value="SBB">SBB</option>
        </select>
        <input type="hidden" id="node-input-pin">
    </div>
    <div class="form-row sbb hidden" id="pin-name-sbb">
        <label for=""><i class="fa fa-bolt"></i> Pin</label>
        <select type="text" id="sbb-pin">
            <option value="PTE24">GRV I2C - SIG1</option>
            <option value="PTE25">GRV I2C - SIG2</option>
            <option value="A4">GRV I/O - SIG1</option>
            <option value="A5">GRV I/O - SIG2</option>
            <option value="PTC12">SBB RIGHT RED</option>
            <option value="PTC3">SBB RIGHT GREEN</option>
            <option value="PTC2">SBB RIGHT BLUE</option>
            <option value="PTA2">SBB LEFT RED</option>
            <option value="PTB23">SBB LEFT GREEN</option>
            <option value="PTA1">SBB LEFT BLUE</option>
            <option value="LED1">K64F RED</option>
            <option value="LED2">K64F GREEN</option>
            <option value="LED3">K64F BLUE</option>
        </select>
    </div>
    <div class="form-row raven hidden" id="pin-name-raven">
        <label for=""><i class="fa fa-bolt"></i> Pin</label>
        <select type="text" id="raven-pin">
            <option value="GRV11">PORT1 - SIG1</option>
            <option value="GRV12">PORT1 - SIG2</option>
            <option value="GRV21">PORT2 - SIG1</option>
            <option value="GRV22">PORT2 - SIG2</option>
            <option value="GRV31">PORT3 - SIG1</option>
            <option value="GRV32">PORT3 - SIG2</option>
            <option value="GRV41">PORT4 - SIG1</option>
            <option value="GRV42">PORT4 - SIG2</option>
            <option value="ULED">USER LED</option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-value"><i class="fa fa-sign-out"></i> Value</label>
        <select type="text" id="node-input-value">
            <option value="">-</option>
            <option value="true">true</option>
            <option value="false">false</option>
        </select>
    <div class="form-row">
        <label for="node-input-append"> </label>
        <input type="checkbox" id="node-input-si" style="display: inline-block; width: auto; vertical-align: middle;">
        &nbsp;Signal Inversion
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="icon-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('digitalout', {
        category: 'EEA',
        color: '#91b122',
        defaults: {
            board: { value: '' },
            pin: { value: '' },
            value: { value: null },
            si: { value: false },
            name: { value: '' }
        },
        inputs: 1,
        outputs: 1,
        icon: 'serial.png',
        label: function () {
            return this.name || 'digitalout';
        },
        oneditprepare: function () {
            $("#node-input-board").change(function () {
                var _board = $("#node-input-board").val();
                if (_board == "SBB") {
                    $("#pin-name-raven").hide();
                    $("#pin-name-sbb").show();
                } else if (_board == "RAVEN") {
                    $("#pin-name-sbb").hide();
                    $("#pin-name-raven").show();
                } else {
                    $("#pin-name-sbb").hide();
                    $("#pin-name-raven").hide();
                }
            })
            $("#sbb-pin").val($("#node-input-pin").val());
            $("#raven-pin").val($("#node-input-pin").val());
        },
        oneditsave: function () {
            var _board = $("#node-input-board").val();
            if (_board == "SBB") {
                $("#node-input-pin").val($("#sbb-pin").val());
            } else if (_board == "RAVEN") {
                $("#node-input-pin").val($("#raven-pin").val());
            } else {
                $("#node-input-pin").val('');
            }
        }
    });
</script>
<script type="text/x-red" data-help-name="digitalout">

    <p> Write digital value to modules. This node is for enebular-edge-agent. </p>

    <h3>Inputs</h3>
    <p>If set <code>-</code> in <code>Value</code>, it is reffer to <code>msg.{pin}</code>.</p>

    <dl class="message-properties">
        <dt class="optional">{pin} <span class="property-type">boolean</span></dt>
        <dd>Value to write to modules.</dd>
    </dl>

    <p>See below, you understand property corresponding to each item of Pin.</p>
    <p>If you write <code>true</code> to SBB RIGHT RED, please set <code>true</code> to <code>msg.PTC12</code>.</p>
    <ul>
        <li>RAVEN</li>
        <ul>
            <li><code>PORT1 - SIG1</code> : GRV11</li>
            <li><code>PORT1 - SIG2</code> : GRV12</li>
            <li><code>PORT2 - SIG1</code> : GRV21</li>
            <li><code>PORT2 - SIG2</code> : GRV22</li>
            <li><code>PORT3 - SIG1</code> : GRV31</li>
            <li><code>PORT3 - SIG2</code> : GRV32</li>
            <li><code>PORT4 - SIG1</code> : GRV41</li>
            <li><code>PORT4 - SIG2</code> : GRV42</li>
            <li><code>USER RED</code> : ULED</li>
        </ul>
        <li>SBB</li>
        <ul>
            <li><code>GRV I2C - SIG1</code> : PTE24</li>
            <li><code>GRV I2C - SIG2</code> : PTE25</li>
            <li><code>GRV I/O - SIG1</code> : A4</li>
            <li><code>GRV I/O - SIG2</code> : A5</li>
            <li><code>SBB RIGHT RED</code> : PTC12</li>
            <li><code>SBB RIGHT GREEN</code> : PTC3</li>
            <li><code>SBB RIGHT BLUE</code> : PTC2</li>
            <li><code>SBB LEFT RED</code> : PTA2</li>
            <li><code>SBB LEFT GREEN</code> : PTB23</li>
            <li><code>SBB LEFT BLUE</code> : PTA1</li>
            <li><code>K64F RED</code> : LED1</li>
            <li><code>K64F GREEN</code> : LED2</li>
            <li><code>K64F BLUE</code> : LED3</li>
        </ul>
    </ul>

    <h3>Outputs</h3>

    <p>This node doesn't change msg object just by writing value to modules.</p>

    <h3>Details</h3>

    <h4>Setting items</h4>
    <ul>
        <li><code>Board</code>： Target board.*1</li>
        <li><code>Pin</code>： Target pin.*1</li>
        <li><code>Value</code>: The value to write to module.</li>
        <li><code>Signal Inversion</code>: Whether to inversion signal or not.</li>
    </ul>

    <p>*1 See below about <code>Board</code> and <code>Pin</code>.</p>

    <h4>Operation on flow editor</h4>
    <p>On flow editor, the nodes for enebular-edge-agent doesn't output value read by module but dummy value on flow editor.</p>
    <p>Output format of the value is equal to on the module. So, able to edit flow by using dummy value.</p>
    <p>In this node, module replaces status.</p>

    <h4>About enebular-edge-agent</h4>

    <p>enebular-edge-agent operates on RAVEN and SBB. Please refer to the following to set the board pin assignment. Deploying settings of different boards Flow is not executed.</p>

    <h5>RAVEN</h5>
    <img src="icons/node-red-contrib-enebular/eea_fig_v2.png">

    <h5>SBB</h5>
    <img src="icons/node-red-contrib-enebular/eea_fig_v1.png">

</script>